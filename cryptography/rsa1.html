<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>7&nbsp; RSA scheme I – Cryptography Challenge</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./modular2.html" rel="next">
<link href="./modular1.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-df76feca8eabcdf26b16ee3dddacfb87.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./asymmetric.html">Asymmetric ciphers</a></li><li class="breadcrumb-item"><a href="./rsa1.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">RSA scheme I</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Cryptography Challenge</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ciphers_vs_codes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to codes and ciphers</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./symmetric.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Symmetric ciphers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./caesar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Caesar cipher</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./monosub.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Monoalphabetic ciphers</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vigenere.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Vigenère cipher</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./enigma.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Enigma</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./asymmetric.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Asymmetric ciphers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modular1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Modular arithmetic I</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rsa1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">RSA scheme I</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modular2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Modular arithmetic II</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rsa2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">RSA scheme II</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./game_resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Cryptography Game Resources</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">7.1</span> Introduction</a></li>
  <li><a href="#key-generation" id="toc-key-generation" class="nav-link" data-scroll-target="#key-generation"><span class="header-section-number">7.2</span> Key generation</a></li>
  <li><a href="#next-steps" id="toc-next-steps" class="nav-link" data-scroll-target="#next-steps"><span class="header-section-number">7.3</span> Next steps</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./asymmetric.html">Asymmetric ciphers</a></li><li class="breadcrumb-item"><a href="./rsa1.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">RSA scheme I</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">RSA scheme I</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<script type="text/javascript">
// wrongColor and rightColor are background colours for input fields signifying
// wrong and correct answers respectively.
const wrongColor = "#fad9d7";  // light red
const rightColor = "#d7fae9";  // light green

// powmod(base, exp, mod) returns (base ^ exp) % mod while avoiding
// overflow/rounding errors.
// In particular, for RSA, encoding involves calculating c = powmod(m, e, n);
// and decoding involves calculating m = powmod(c, d, n).
function powmod(base, exp, mod) {
    let result = 1;
    for (let i = 0; i < exp; i++) {
        result = (result * base) % mod;
    }
    return result;
}

// enforcePosNumberInput(inputId) ensures that the value of the input
// elemeent with the id `inputId` is a positive integer. It does so by removing
// any characters that are not digits, and if the resulting value is 0, clears
// the input.
function enforcePosNumberInput(inputId) {
    let d = document.getElementById(inputId).value;
    d = d.replace(/\D/g, "");
    if (parseInt(d) === 0) d = ""; 
    document.getElementById(inputId).value = d;
}

</script>
<script type="module">
function isPrime(num) {
    if (num < 2 || isNaN(num)) return false;

    for (let i = 2; i <= Math.sqrt(num); i++) {
        if (num % i == 0) return false;
    }
    return true;
}

// using Euclid's algorithm
function gcd(n1, n2) {
    if (n1 <= 0 || n2 <= 0 || isNaN(n1) || isNaN(n2)) return false;

    const x = Math.max(n1, n2);
    const y = Math.min(n1, n2);

    const r = x % y;
    if (r == 0) return y;
    else return gcd(y, r);
}

function recalcNPhi() {
    const p = parseInt(document.getElementById("rsa-p").value);
    const q = parseInt(document.getElementById("rsa-q").value);

    if (isNaN(p) || isNaN(q) || p < 2 || q < 2) {
        return null;
    }

    // make sure both are valid primes
    const p_prime = isPrime(p);
    const q_prime = isPrime(q);
    const outdiv = document.getElementById("rsa-pq-out");
    if (p_prime && q_prime) {
        const n = p * q;
        const phi = (p - 1) * (q - 1);
        const space = "&nbsp;".repeat(4);
        outdiv.style.color = "green";
        outdiv.innerHTML = `⇒   OK! n = ${n}; ${space} φ = ${p - 1} × ${q - 1} = ${phi}`;
        return [n, phi];
    }
    else if (!p_prime) {
        outdiv.style.color = "red";
        outdiv.innerHTML = "p is not prime";
        return null;
    }
    else {
        outdiv.style.color = "red";
        outdiv.innerHTML = "q is not prime";
        return null;
    }
}

function recalcE(phi) {
    const e = parseInt(document.getElementById("rsa-e").value);
    const outdiv = document.getElementById("rsa-e-out");
    if (isNaN(e) || e < 2) {
        return null;
    }
    else if (e > phi) {
        outdiv.style.color = "red";
        outdiv.innerHTML = `⇒   e cannot be larger than φ`;
        return null;
    }
    else {
        const factor = gcd(e, phi);
        if (factor == 1) {
            outdiv.style.color = "green";
            outdiv.innerHTML = "⇒   OK!";
            return e;
        } else {
            outdiv.style.color = "red";
            outdiv.innerHTML = `⇒   e and φ share a factor of ${factor}`;
            return null;
        }
    }
}

function recalcD(e, phi) {
    const d = parseInt(document.getElementById("rsa-d").value);
    const outdiv = document.getElementById("rsa-d-out");

    if (isNaN(d) || d < 2) {
        outdiv.innerHTML = "";
        return null;
    }
    else {
        const emodphi = e % phi;
        const dmodphi = d % phi;
        const edmodphi = (emodphi * dmodphi) % phi;
        if (edmodphi == 1) {
            outdiv.style.color = "green";
            outdiv.innerHTML = `⇒ OK! d × e = ${e * d} ≡ ${edmodphi} mod ${phi}`;
            return d;
        }
        else {
            outdiv.style.color = "red";
            outdiv.innerHTML = `⇒ d × e = ${e * d} ≡ ${edmodphi} mod ${phi}`;
            return null;
        }
    }
}

function recalcM(e, d, n) {
    const m = parseInt(document.getElementById("rsa-m").value);
    const outdiv = document.getElementById("rsa-m-out");

    if (isNaN(m) || m < 0) {
        outdiv.style.color = "red";
        outdiv.innerHTML = "m cannot be negative";
        // Should never reach here as the input is sanitised
        return;
    }
    else if (m > n) {
        outdiv.style.color = "red";
        outdiv.innerHTML = "m cannot be larger than n";
        return;
    }
    else {
        const c = powmod(m, e, n);
        const m2 = powmod(c, d, n);
        outdiv.innerHTML = `⇒ [Encode] c = ${m}^${e} mod ${n} = ${c}<br>⇒ [Decode] m = ${c}^${d} mod ${n} = ${m2}`;
        if (m == m2) {
            outdiv.style.color = "green";
        }
        else {
            outdiv.style.color = "red";   // Shouldn't happen, but yeah.
        }
    }
}

function recalc() {
    // make sure all inputs are positive numbers
    for (const id of ["rsa-p", "rsa-q", "rsa-e", "rsa-d", "rsa-m"]) {
        enforcePosNumberInput(id);
    }
    // clear all outputs
    for (const id of ["rsa-pq-out", "rsa-e-out", "rsa-d-out", "rsa-m-out"]) {
        document.getElementById(id).innerHTML = "";
    }
    // recalculate outputs
    const result1 = recalcNPhi();
    if (result1 !== null) {
        const [n, phi] = result1;
        const e = recalcE(phi);
        if (e !== null) {
            const d = recalcD(e, phi);
            if (d !== null) {
                recalcM(e, d, n);
            }
        }
    }
}

function factorise(n, existing_factors) {
    if (n == 1) return existing_factors;

    for (let i = 2; i <= Math.ceil(Math.sqrt(n)); i++) {
        if (n % i == 0) {
            n = n / i;
            existing_factors.push(i);
            return factorise(n, existing_factors);
        }
    }
    // No factors found -- n is prime
    return existing_factors.concat([n]);
}

// calculate gcd(a,b) but with b already factorised. Much faster if b is a constant.
function gcd2(a, prime_factors_of_b) {
    for (const f of prime_factors_of_b) {
        if (a % f == 0) {
            return f;
        }
    }
    return 1;
}

// calculates a value for e based on p and q
function generateE() {
    const result1 = recalcNPhi();
    if (result1 !== null) {
        const [_, phi] = result1;
        // Tabulate all possible values of e
        let possibleEs = [];
        const factorisedPhi = factorise(phi, []);
        for (let e = 2; e < phi; e++) {
            if (gcd2(e, factorisedPhi) === 1) {
                possibleEs.push(e);
            }
        }
        // Choose a random one
        console.log(possibleEs);
        const chosen = possibleEs[Math.floor(Math.random() * possibleEs.length)];
        document.getElementById("rsa-e").value = chosen;
        recalc();
        return;
    }
}

// calculates modular inverse -- not with Bezout's identity, but by brute force
function modinv(e, phi) {
    for (let d = 2; d < phi; d++) {
        if ((e * d) % phi == 1) {
            return d;
        }
    }
    return null;
}

function generateD() {
    const result1 = recalcNPhi();
    if (result1 !== null) {
        const [_, phi] = result1;
        const e = recalcE(phi);
        if (e !== null) {
            const d = modinv(e, phi);
            if (d !== null) {
                document.getElementById("rsa-d").value = d;
                recalc();
                return;
            }
        }
    }
}

function generatePQ() {
    const primes = [2, 3, 5, 7, 11, 13, 17,
        19, 23, 29, 31, 37, 41, 43, 47, 53,
        59, 61, 67, 71, 73, 79, 83, 89, 97,
        101, 103, 107, 109, 113, 127, 131,
        137, 139, 149];
    // Sample without replacement
    const p = primes[Math.floor(Math.random() * primes.length)];
    const primes2 = primes.filter(x => x != p);
    const q = primes2[Math.floor(Math.random() * primes2.length)];
    document.getElementById("rsa-p").value = p;
    document.getElementById("rsa-q").value = q;
    recalc();
}

document.getElementById("rsa-p").addEventListener("input", recalc);
document.getElementById("rsa-q").addEventListener("input", recalc);
document.getElementById("rsa-e").addEventListener("input", recalc);
document.getElementById("rsa-d").addEventListener("input", recalc);
document.getElementById("rsa-m").addEventListener("input", recalc);
document.getElementById("rsa-e-hint").addEventListener("click", generateE);
document.getElementById("rsa-d-hint").addEventListener("click", generateD);
document.getElementById("rsa-pq-hint").addEventListener("click", generatePQ);
recalc();

</script>
<p>The RSA scheme is one of the most important asymmetric-key systems, and is widely used as part of the steps in encrypting Internet communications.</p>
<p>The RSA scheme is named after the surnames of its three inventors: Ron Rivest, Adi Shamir, and Leonard Adleman. Although they were the first to publicly describe the RSA system in 1977, an equivalent algorithm had in fact been discovered four years ago by Clifford Cocks, who worked at GCHQ.</p>
<section id="introduction" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">7.1</span> Introduction</h2>
<p>The RSA scheme revolves around modular arithmetic, which the previous page touched briefly on.</p>
<p>Specifically, it assumes that the message you want to transmit is first translated into an integer <span class="math inline">\(m\)</span> (which stands for message).</p>
<blockquote class="blockquote">
<p><strong>Question:</strong> Can you come up with a way of translating a plain-text message into an integer?</p>
</blockquote>
<ol type="1">
<li><p>The <em>encoding</em> step involves the sender taking the message <span class="math inline">\(m\)</span> and raising it to a power <span class="math inline">\(e\)</span> (for ‘encryption’), modulo some number <span class="math inline">\(n\)</span>:</p>
<p><span class="math display">\[c \equiv m^e \mod n\]</span></p>
<p>where <span class="math inline">\(c\)</span> is the <em>ciphertext</em>. The combination of <span class="math inline">\(e\)</span> and <span class="math inline">\(n\)</span> forms the <em>public key</em> of the RSA scheme.</p></li>
<li><p>This ciphertext is then passed to the recipient, who then <em>decodes</em> it by raising it to a power <span class="math inline">\(d\)</span> (for ‘decryption’), modulo <span class="math inline">\(n\)</span>:</p>
<p><span class="math display">\[m \equiv c^d \mod n.\]</span></p>
<p><span class="math inline">\(d\)</span> forms part of the <em>private key</em>, which only the recipient is allowed to know.</p></li>
</ol>
<p>The two equations above imply together that:</p>
<p><span class="math display">\[m \equiv (m^e)^d \mod n,\]</span></p>
<p>and crucially, this is true of <em>all</em> messages <span class="math inline">\(m &lt; n\)</span>, meaning that the keys can be used for whatever message you choose to send.</p>
<p>In general, if we just pick any random numbers <span class="math inline">\(e\)</span>, <span class="math inline">\(d\)</span>, and <span class="math inline">\(n\)</span>, this will not be true! The RSA scheme works because these numbers are specifically chosen in a way that not only satisfies the equation above, but is also difficult to reverse-engineer.</p>
<p>Specifically, if you were an attacker and you knew the public key (i.e.&nbsp;<span class="math inline">\(e\)</span> and <span class="math inline">\(n\)</span>) <em>as well as</em> the ciphertext <span class="math inline">\(c\)</span>, it’s still extremely difficult to find the correct value of <span class="math inline">\(d\)</span> to correctly decode the message.</p>
</section>
<section id="key-generation" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="key-generation"><span class="header-section-number">7.2</span> Key generation</h2>
<p>Because the RSA scheme is asymmetric, it only works for communication in one way. The <em>recipient</em> is responsible for generating the three integers <span class="math inline">\(e\)</span>, <span class="math inline">\(d\)</span>, and <span class="math inline">\(n\)</span>. They do so using the following algorithm:</p>
<ol type="1">
<li><p>Choose two prime numbers <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span>, and set <span class="math inline">\(n = pq\)</span>.</p>
<p>For example, if we choose <span class="math inline">\(p = 5\)</span> and <span class="math inline">\(q = 13\)</span>, then <span class="math inline">\(n = 65\)</span>.</p></li>
<li><p>Calculate the <em>totient function</em>, defined by <span class="math inline">\(\phi = (p - 1)(q - 1)\)</span>. (That symbol is the Greek letter phi.) In this case, we would have <span class="math inline">\(\phi = 4 \times 12 = 48\)</span>.</p>
<p>Then, choose an integer <span class="math inline">\(e\)</span> which is smaller than <span class="math inline">\(\phi\)</span> and has no common prime factors with <span class="math inline">\(\phi\)</span>. Here, the only prime factors of <span class="math inline">\(48\)</span> are <span class="math inline">\(2\)</span> and <span class="math inline">\(3\)</span>: so, a valid choice would be <span class="math inline">\(e = 5\)</span>.</p>
<p><span class="math inline">\(e\)</span> and <span class="math inline">\(n\)</span> are part of the public key, and can be shared with the sender.</p></li>
<li><p>Finally, choose <span class="math inline">\(d\)</span> such that <span class="math inline">\(de \equiv 1 \bmod\phi\)</span>.</p>
<p>In this case, we need <span class="math inline">\(d \times 5 \equiv 1 \bmod 48\)</span>: the smallest value of <span class="math inline">\(d\)</span> for which this holds true is <span class="math inline">\(d = 29\)</span>. (Can you verify this?)</p>
<p><span class="math inline">\(d\)</span> is part of the private key, and must be kept secret.</p></li>
</ol>
<p>This setup ensures that regardless of what message <span class="math inline">\(m\)</span> is being sent, <span class="math display">\[(m^e)^d \equiv m \bmod n,\]</span> as required by the RSA algorithm.</p>
<p>Try this out using the interactive form here. It has been pre-filled with the numbers from the example above, but you should try it out with your own choice of numbers.</p>
<ul>
<li><strong>Step 1</strong>: Choose <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> (must be prime)
<div class="rsa-grid-1">
<div id="rsa-pq-in">
<p><span class="math inline">\(p\)</span>: <input type="text" id="rsa-p" value="5" size="3"> <span class="math inline">\(q\)</span>: <input type="text" id="rsa-q" value="13" size="3"> &nbsp;&nbsp;&nbsp; &nbsp; <input type="button" id="rsa-pq-hint" value="(hint)" class="hint"></p>
</div>
<div id="rsa-pq-out">

</div>
</div></li>
<li><strong>Step 2</strong>: Choose <span class="math inline">\(e\)</span> (encryption key: must be smaller than <span class="math inline">\(\phi\)</span>, and cannot share prime factors with <span class="math inline">\(\phi\)</span>)
<div class="rsa-grid-1">
<div id="rsa-e-in">
<p><span class="math inline">\(e\)</span>: <input type="text" id="rsa-e" value="5" size="3"> &nbsp;&nbsp;&nbsp; &nbsp; <input type="button" id="rsa-e-hint" value="(hint)" class="hint"></p>
</div>
<div id="rsa-e-out">

</div>
</div></li>
<li><strong>Step 3</strong>: Choose <span class="math inline">\(d\)</span> (decryption key: must satisfy <span class="math inline">\(de \equiv 1 \bmod \phi\)</span>)
<div class="rsa-grid-1">
<div id="rsa-d-in">
<p><span class="math inline">\(d\)</span>: <input type="text" id="rsa-d" value="29" size="3"> &nbsp;&nbsp;&nbsp; &nbsp; <input type="button" id="rsa-d-hint" value="(hint)" class="hint"></p>
</div>
<div id="rsa-d-out">

</div>
</div></li>
<li><strong>Step 4</strong>: Choose <span class="math inline">\(m\)</span> (message: must be smaller than <span class="math inline">\(n\)</span>)
<div class="rsa-grid-1">
<div id="rsa-m-in">
<p><span class="math inline">\(m\)</span>: <input type="text" id="rsa-m" value="7" size="3"></p>
</div>
<div id="rsa-m-out">

</div>
</div></li>
</ul>
</section>
<section id="next-steps" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="next-steps"><span class="header-section-number">7.3</span> Next steps</h2>
<p>We’ve managed to show here that the RSA scheme <em>works</em>. However, there are several questions that remain:</p>
<ol type="1">
<li>Unless you chose very small numbers for <span class="math inline">\(p\)</span>, <span class="math inline">\(q\)</span>, and <span class="math inline">\(e\)</span>, you probably found it hard to calculate <span class="math inline">\(d\)</span>. How can this be done quickly?</li>
<li>How do we know that the RSA scheme is <em>secure</em>? Is it possible to obtain the private key, <span class="math inline">\(d\)</span>, if you have the public key (<span class="math inline">\(e\)</span> and <span class="math inline">\(n\)</span>)?</li>
<li>why does the RSA algorithm work at all, i.e.&nbsp;why is it always true that <span class="math inline">\((m^e)^d \equiv m \bmod n\)</span>?</li>
</ol>
<p>We’ll cover the first two questions in the remainder of today.</p>
<p>The proof that RSA works requires slightly more mathematical knowledge than we’ve seen so far, so we will not be covering it today. If you are curious, you can find it <a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)#Proofs_of_correctness">on Wikipedia</a>!</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./modular1.html" class="pagination-link" aria-label="Modular arithmetic I">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Modular arithmetic I</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./modular2.html" class="pagination-link" aria-label="Modular arithmetic II">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Modular arithmetic II</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>